prep:

brew install kubernetes-helm
helm init --client-only
helm repo add alfresco-stable https://kubernetes-charts.alfresco.com/stable
helm dependency update
* import both BNotK certificates from https://wiki.westernacher.com/x/hg9WAw into local keystore, edit trust settings for ssl, and restart docker
docker login -u vpn-werner westernacher-docker.artifactory.test.bnotk.net


copy images – target names must start with prefix com.westernacher:

docker pull quay.io/alfresco/alfresco-transform-router:1.0.2.1
docker tag quay.io/alfresco/alfresco-transform-router:1.0.2.1 westernacher-docker.artifactory.test.bnotk.net/com.westernacher.alfresco-transform-router:1.0.2.1
docker push westernacher-docker.artifactory.test.bnotk.net/com.westernacher.alfresco-transform-router:1.0.2.1


local test:

brew cask install virtualbox
minikube start --memory 8000
* set replicaCount to 1 in values.yaml
kubectl create secret docker-registry quay.io --docker-server=quay.io --docker-username=alfresco+customer-32725-bundesnotarkammer --docker-password=...
minikube ip
helm install stable/nginx-ingress --set rbac.create=true
kubectl get service intentional-swan-nginx-ingress-controller -o jsonpath={.spec.ports[0].nodePort}
* fix validation errors in helm charts
kubectl apply -f ../persistent-volume.yaml
helm install alfresco-content-services --set externalProtocol="http" --set externalHost="192.168.99.100" --set externalPort="31845" --set registryPullSecrets=quay.io
open https://192.168.99.100:30832/alfresco
